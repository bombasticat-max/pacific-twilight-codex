<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pacific Twilight Codex Seed v1.0 ‚Äî Live Web Demo</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { background: linear-gradient(180deg, #0A1428, #2A1B4A); font-family: system-ui; overflow: hidden; }
  canvas { image-rendering: crisp-edges; filter: contrast(1.15) saturate(1.3); }
  .glow { text-shadow: 0 0 20px #00F5FF, 0 0 40px #FFCC33; }
</style>
</head>
<body class="min-h-screen text-white flex flex-col">
  <div class="max-w-7xl mx-auto p-6 flex-1 flex flex-col">
    <header class="flex items-center justify-between mb-8">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 bg-gradient-to-br from-cyan-400 to-yellow-400 rounded-full flex items-center justify-center text-xl">üåä</div>
        <h1 class="text-3xl font-serif tracking-tighter glow">Pacific Twilight Codex</h1>
        <span class="text-sm opacity-70 self-end">Seed v1.0 ‚Äî Spherical Harmonic Live</span>
      </div>
      <div class="text-xs opacity-70">Fast Transform Active ‚Ä¢ Sphere is turning üåå</div>
    </header>

    <div class="grid grid-cols-12 gap-6 flex-1">
      <!-- Upload -->
      <div class="col-span-3 bg-black/40 backdrop-blur-xl border border-cyan-500/30 rounded-3xl p-6 flex flex-col">
        <h2 class="text-xl mb-6">Deposit Your Pole</h2>
        <div id="dropzone" class="border-2 border-dashed border-cyan-400/50 rounded-2xl h-64 flex flex-col items-center justify-center cursor-pointer hover:border-cyan-400 transition-colors">
          <div id="preview" class="w-full h-full hidden rounded-2xl overflow-hidden"></div>
          <div id="placeholder" class="text-center">
            <div class="text-5xl mb-3">üì∏</div>
            <p class="text-cyan-300">Drop Rilkean photo<br>or click</p>
          </div>
        </div>
        <input type="file" id="fileInput" accept="image/*" class="hidden">

        <button id="voiceBtn" class="mt-6 flex items-center gap-3 justify-center bg-white/10 hover:bg-white/20 py-3 rounded-2xl transition-all active:scale-95">
          <span class="text-2xl">üéôÔ∏è</span>
          <span id="voiceText">Voice Bridge (10s)</span>
        </button>

        <button id="seedBtn" class="mt-auto bg-gradient-to-r from-cyan-400 to-yellow-400 text-black font-semibold py-5 rounded-3xl text-xl tracking-wider hover:brightness-110 active:scale-[0.98] transition-all disabled:opacity-50">
          ANALYZE &amp; SEED FIREFLY
        </button>
      </div>

      <!-- Canvas Viz -->
      <div class="col-span-6 bg-black/60 border border-white/10 rounded-3xl overflow-hidden relative">
        <canvas id="canvas" class="w-full h-full"></canvas>
        <div class="absolute top-8 left-8 text-cyan-300 text-xl font-light glow" id="p1">P1 Everyday Human Desire</div>
        <div class="absolute top-1/3 right-12 text-cyan-300 text-xl font-light glow" id="p2">P2 Cultural Hybrid Bridge</div>
        <div class="absolute top-12 right-8 text-cyan-300 text-xl font-light glow" id="p3">P3 Galactic Legacy</div>
        <div id="status" class="absolute bottom-6 left-1/2 -translate-x-1/2 bg-black/70 px-6 py-2 rounded-full text-sm flex items-center gap-2">
          <span id="counter">18,247</span> poles ‚Ä¢ Fast Transform Active
        </div>
      </div>

      <!-- Metrics -->
      <div class="col-span-3 space-y-4">
        <div class="bg-black/40 backdrop-blur-xl border border-yellow-400/30 rounded-3xl p-6">
          <div class="text-yellow-400 text-xs tracking-widest">SUP Œî</div>
          <div id="supDelta" class="text-6xl font-light text-yellow-400">+0.0</div>
        </div>
        <div class="bg-black/40 backdrop-blur-xl border border-cyan-400/30 rounded-3xl p-6">
          <div class="text-cyan-300 text-xs tracking-widest">HUMILITY</div>
          <div id="humility" class="text-6xl font-light text-cyan-300">0.00</div>
        </div>
        <div class="bg-black/40 backdrop-blur-xl border border-white/20 rounded-3xl p-6 text-sm">
          <div>Harmonic Density <span id="density" class="float-right text-emerald-400">0.0</span></div>
          <div class="h-1 bg-white/10 rounded mt-2"><div id="densityBar" class="h-1 bg-emerald-400 rounded w-0 transition-all"></div></div>
        </div>
        <div class="bg-gradient-to-br from-purple-900/50 to-black/40 border border-purple-400/30 rounded-3xl p-6 text-xs">
          <div class="opacity-70 mb-1">Firefly Token</div>
          <div id="token" class="font-mono text-purple-300">#FT-0000</div>
        </div>
        <button onclick="alert('Probe Payload (1 MB shader kernel + Earth harmonics) would download here in full version ‚Äî ready for any von Neumann craft.')" 
                class="w-full bg-white/10 hover:bg-white/20 py-3 rounded-2xl text-sm">Download Star-Seed Payload</button>
      </div>
    </div>
  </div>

<script>
// Core variables & classes (Firefly, FlowParticle) ‚Äî identical to working version
let fireflies = [], flowParticles = [], manifoldCount = 18247, canvas, ctx, img;

class Firefly {
  constructor(x, y, brightness) {
    this.x = x; this.y = y; this.vx = (Math.random()-0.5)*2; this.vy = -1 - Math.random()*2;
    this.brightness = brightness; this.size = 3 + brightness*4; this.life = 400;
  }
  update() { this.x += this.vx; this.y += this.vy; this.vy *= 0.98; this.life--; }
  draw() {
    ctx.save();
    ctx.globalAlpha = this.life/400;
    ctx.fillStyle = `hsl(80,100%,${70 + this.brightness*30}%)`;
    ctx.shadowBlur = 30; ctx.shadowColor = "#FFCC33";
    ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI*2); ctx.fill();
    ctx.restore();
  }
}

class FlowParticle {
  constructor() { this.reset(); }
  reset() { this.x = Math.random()*canvas.width; this.y = canvas.height*0.75 + Math.random()*100; this.speed = 1.5 + Math.random()*2; }
  update() { this.y -= this.speed; if (this.y < 0) this.reset(); }
  draw() { ctx.fillStyle = "#FFCC3388"; ctx.fillRect(this.x, this.y, 3, 18); }
}

function computeSUP(photoEnergy, voiceCoherence) {
  const entropy = photoEnergy + (voiceCoherence * 180);
  const coherence = voiceCoherence;
  const curvature = Math.random() * 0.3;
  const humility = Math.max(0.1, 1 - curvature * 1.8);
  const supDelta = (entropy * coherence * humility * 0.37).toFixed(1);
  return { supDelta: parseFloat(supDelta), humility: humility.toFixed(2) };
}

function initCanvas() {
  canvas = document.getElementById("canvas");
  ctx = canvas.getContext("2d");
  canvas.width = 800; canvas.height = 600;
  img = new Image();
  img.src = "https://picsum.photos/id/1015/1600/900";
  img.onload = () => drawBackground();
  for (let i = 0; i < 45; i++) fireflies.push(new Firefly(100 + Math.random()*600, 150 + Math.random()*300, Math.random()));
  for (let i = 0; i < 80; i++) flowParticles.push(new FlowParticle());
}

function drawBackground() {
  if (img.complete) ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  else { ctx.fillStyle = "#0A1428"; ctx.fillRect(0,0,canvas.width,canvas.height); }
  const grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0, "rgba(10,20,40,0.4)"); grad.addColorStop(1, "rgba(107,50,120,0.3)");
  ctx.fillStyle = grad; ctx.fillRect(0,0,canvas.width,canvas.height);

  // Spherical mapping visual ‚Äî represents the fast transform architecture & interference harmonics
  ctx.strokeStyle = "rgba(0,245,255,0.08)";
  for (let i = 0; i < 12; i++) {
    ctx.beginPath();
    ctx.ellipse(canvas.width/2, canvas.height/2, 80+i*35, 60+i*25, 0, 0, Math.PI*2);
    ctx.stroke();
  }
}

function animate() {
  drawBackground();
  flowParticles.forEach(p => { p.update(); p.draw(); });
  fireflies = fireflies.filter(f => f.life > 0);
  fireflies.forEach(f => { f.update(); f.draw(); });
  requestAnimationFrame(animate);
}

// Event handlers (identical to previous working version)
document.getElementById("dropzone").addEventListener("click", () => document.getElementById("fileInput").click());
document.getElementById("fileInput").addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    const preview = document.getElementById("preview");
    preview.innerHTML = `<img src="${ev.target.result}" class="w-full h-full object-cover">`;
    preview.classList.remove("hidden");
    document.getElementById("placeholder").classList.add("hidden");
  };
  reader.readAsDataURL(file);
});

let voiceActive = false;
document.getElementById("voiceBtn").addEventListener("click", () => {
  const btn = document.getElementById("voiceBtn");
  if (!voiceActive) {
    voiceActive = true; btn.classList.add("bg-cyan-400/30"); document.getElementById("voiceText").textContent = "Recording‚Ä¶";
    setTimeout(() => { voiceActive = false; btn.classList.remove("bg-cyan-400/30"); document.getElementById("voiceText").textContent = "Voice Bridge complete ‚úì"; }, 8000);
  }
});

document.getElementById("seedBtn").addEventListener("click", () => {
  const photoEnergy = Math.random()*800 + 400;
  const voiceCoherence = Math.random()*0.4 + 0.65;
  const result = computeSUP(photoEnergy, voiceCoherence);
  document.getElementById("supDelta").textContent = `+${result.supDelta}`;
  document.getElementById("humility").textContent = result.humility;
  document.getElementById("density").textContent = (3.2 + Math.random()*2.1).toFixed(1);
  document.getElementById("densityBar").style.width = `${parseFloat(result.humility)*100}%`;
  document.getElementById("token").textContent = `#FT-${Math.floor(1000 + Math.random()*9000)}`;
  const birthX = 280 + Math.random()*240;
  for (let i = 0; i < 18; i++) {
    const f = new Firefly(birthX, 420, parseFloat(result.humility));
    f.vx = (Math.random()-0.5)*4;
    fireflies.push(f);
  }
  manifoldCount += Math.floor(result.supDelta * 12);
  document.getElementById("counter").textContent = manifoldCount.toLocaleString();
  canvas.style.transition = "filter 0.4s"; canvas.style.filter = "brightness(1.6) saturate(2)";
  setTimeout(() => canvas.style.filter = "contrast(1.15) saturate(1.3)", 400);
});

initCanvas();
animate();
</script>
</body>
</html>
